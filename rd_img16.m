function image_data=rd_img16(filename)% Reads Fluoview Tiff image series% By David Kolin, August 2003info = imfinfo(filename);image_data = repmat(uint16(0),[info(1).Height info(1).Width max(size(info))]);  %%%%%%% changed (info,2) to 1, Ben RappazdisplayWaitbar = 0;if displayWaitbar    h = waitbar(0,'Loading image series...');end% If it's an RGB image, average all three colors to give mean "gray" imageif info(1).SamplesPerPixel == 3    warning('RGB channels are being averaged!')    for frame=1:max(size(info))                    %%%%%%%%%%% changed to 1 (was 2) Ben Rappaz        image_data(:,:,frame) = mean(imread(filename,frame),3);        try            if displayWaitbar                waitbar(frame/max(size(info)),h)   %%%%%%%%%%% changed to 1 (was 2) Ben Rappaz            end        catch % if user closed waitbar            image_data = 0;            return        end    endelse    for frame=1:max(size(info))                    %%%%%%%%%%% changed to 1 (was 2) Ben Rappaz        [image_data(:,:,frame),map] = imread(filename,frame);        try             if displayWaitbar                waitbar(frame/max(size(info)),h)            end        catch % if user closed waitbar            image_data = 0;            return        end    endendif displayWaitbar    close(h)end